<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Module containing everything related to the processing of a single libp2p connection."><meta name="keywords" content="rust, rustlang, rust-lang, connection"><title>smoldot::libp2p::connection - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings"></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../smoldot/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><p class="location">Module connection</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li></ul></div><p class="location"><a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">libp2p</a></p><div id="sidebar-vars" data-name="connection" data-ty="mod" data-relpath="../"></div><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../../index.html">smoldot</a>::<wbr><a href="../index.html">libp2p</a>::<wbr><a class="mod" href="">connection</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/smoldot/libp2p/connection.rs.html#18-85" title="goto source code">[src]</a></span></h1><div class="docblock"><p>Module containing everything related to the processing of a single libp2p connection.</p>
<h1 id="overview" class="section-header"><a href="#overview">Overview</a></h1>
<p>Libp2p connections use TCP sockets provided by the operating system.</p>
<blockquote>
<p><strong>Note</strong>: Explaining the TCP/IP protocol is out of scope of this documentation. See for
example <a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol">the Wikipedia page</a>
for more information.</p>
</blockquote>
<p>Once a TCP connection has been established, the <em>handshake</em> phase starts. This handshake
is described in details in the documentation <a href="../../../smoldot/libp2p/connection/handshake/index.html" title="handshake"><code>handshake</code></a> module.</p>
<p>The handshake consists in negotiating with the remote an encryption layer, thanks to which all
communications are encrypted, and a multiplexing layer, thanks to which the stream of data can
be split into a multitude of <strong>substreams</strong>.</p>
<p>After the handshake is over, the connection is now in the <em>established</em> phase. See the
documentation of the <a href="../../../smoldot/libp2p/connection/established/index.html" title="established"><code>established</code></a> module for more details.</p>
<p>Once in the established phase, substreams can be opened either by the local endpoint or by the
remote endpoint. When a substream is opened, a protocol is first negotiated in order to
determine the purpose of this substream. Two kinds of protocols, and therefore two kinds of
substreams, are supported:</p>
<ul>
<li>So-called “request-response” substreams. After the protocol is negotiated, the opening side
sends a single message containing a request, and the other endpoint sends back a single
message containing a response. The substream is then closed.</li>
<li>So-called “notifications” substreams. After the protocol is negotiated, the opening side
sends a single handshake message. The other endpoint must then either immediately close the
substream to reject the handshake, or send back a handshake in order to accept it. After the
handshake is accepted, the opening side can send an unbounded number of individual messages.
Only the opening side is allowed to send messages on any given notifications substream.</li>
</ul>
<p>These two kinds of substreams serve as a base framework. The exact nature of these
request-responses and of these notifications is out of scope of this module.</p>
<h1 id="usage" class="section-header"><a href="#usage">Usage</a></h1>
<p>To connect to a libp2p node, start by establishing a TCP connection with the target. This can
be done either through an outgoing connection or connection incoming from a TCP listening
socket.</p>
<blockquote>
<p><strong>Note</strong>: This module only contains <em>no_std</em>-friendly code, and creating TCP connections
isn’t handled by it.</p>
</blockquote>
<p>After a TCP connection is established, use <a href="../../../smoldot/libp2p/connection/handshake/struct.HealthyHandshake.html#method.new" title="handshake::HealthyHandshake::new"><code>handshake::HealthyHandshake::new</code></a> to initialize
the state machine that needs to be maintained in parallel of the connection. The data send and
received over the socket must respectively be obtained or injected using
<a href="../../../smoldot/libp2p/connection/handshake/struct.HealthyHandshake.html#method.read_write" title="handshake::HealthyHandshake::read_write"><code>handshake::HealthyHandshake::read_write</code></a>. See the <a href="../../../smoldot/libp2p/connection/handshake/index.html" title="handshake"><code>handshake</code></a> module documentation for
more details.</p>
<p>Keep in mind that the <a href="../../../smoldot/libp2p/connection/handshake/index.html" title="handshake"><code>handshake</code></a> module doesn’t provide any timeout. Users are strongly
encouraged to add one, in order to detect situations where the remote is, intentionally or
not, unresponsive.</p>
<p>After the handshake is successful, use <a href="../../../smoldot/libp2p/connection/established/struct.ConnectionPrototype.html#method.into_connection" title="established::ConnectionPrototype::into_connection"><code>established::ConnectionPrototype::into_connection</code></a>
to obtain an <a href="../../../smoldot/libp2p/connection/established/struct.Established.html" title="established::Established"><code>established::Established</code></a>. Similar to the handshake, use
<a href="../../../smoldot/libp2p/connection/established/struct.Established.html#method.read_write" title="established::Established::read_write"><code>established::Established::read_write</code></a> to update the state machine.</p>
</div><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<table><tr><td><code>pub use noise::<a class="struct" href="../../../smoldot/libp2p/connection/noise/struct.NoiseKey.html" title="struct smoldot::libp2p::connection::noise::NoiseKey">NoiseKey</a>;</code></td></tr><tr><td><code>pub use noise::<a class="struct" href="../../../smoldot/libp2p/connection/noise/struct.UnsignedNoiseKey.html" title="struct smoldot::libp2p::connection::noise::UnsignedNoiseKey">UnsignedNoiseKey</a>;</code></td></tr></table><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="established/index.html" title="smoldot::libp2p::connection::established mod">established</a></td><td class="docblock-short"><p>State machine handling a single TCP or WebSocket libp2p connection.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="handshake/index.html" title="smoldot::libp2p::connection::handshake mod">handshake</a></td><td class="docblock-short"><p>State machine handling the handshake with a TCP or WebSocket libp2p connection.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="multistream_select/index.html" title="smoldot::libp2p::connection::multistream_select mod">multistream_select</a></td><td class="docblock-short"><p>Multistream-select is a protocol whose purpose is to negotiate protocols.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="noise/index.html" title="smoldot::libp2p::connection::noise mod">noise</a></td><td class="docblock-short"><p>Noise protocol libp2p layer.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="yamux/index.html" title="smoldot::libp2p::connection::yamux mod">yamux</a></td><td class="docblock-short"><p>Yamux multiplexing protocol.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="smoldot" data-search-js="../../../search-index.js"></div>
    <script src="../../../main.js"></script></body></html>